# `useDataTable` Documentation

`useDataTable` is a custom hook that generates a table instance using the `@tanstack/react-table` library. This hook leverages Zustand for state management to store and set table preferences, such as pagination, sorting, column visibility, and pinning. The hook is highly configurable and can handle subcomponents and draggable rows within the table.

## Table of Contents

- [`useDataTable` Documentation](#usedatatable-documentation)
  - [Table of Contents](#table-of-contents)
  - [Functionality](#functionality)
  - [Parameters](#parameters)
  - [Return Value](#return-value)
  - [State Management](#state-management)
  - [Usage Example](#usage-example)
  - [Dependencies](#dependencies)
    - [back to Datatable Library Overview](#back-to-datatable-library-overview)

## Functionality

The `useDataTable` hook creates a fully-featured table instance with the ability to manage and persist table state preferences using Zustand. It supports advanced table features, including:

- **Pagination**: Managing the current page and page size.
- **Sorting**: Handling multi-column sorting with custom configurations.
- **Column Visibility and Pinning**: Allowing dynamic visibility and pinning of columns.
- **Draggable Rows**: Enabling drag-and-drop functionality for rows.
- **Subcomponents**: Managing the expansion of rows to display subcomponents.

The hook automatically synchronizes the table state with the Zustand store, ensuring that user preferences are preserved across renders and interactions.

## Parameters

The hook accepts the following parameters:

- **`tableId: string`**  
  Unique identifier for the table instance. This is used to manage and persist state within the Zustand store.

- **`defaultData: TData[]`**  
  The default dataset to be displayed in the table.

- **`defaultColumns: ColumnDef<any, any>[]`**  
  The default column definitions used to configure the table's columns.

- **`initialConfig?: Partial<ColumnDef<TData, unknown>>`**  
  Initial configuration for the columns, including size, resizing, sorting, pinning, and filtering options.

- **`isSubComponent?: boolean`**  
  A boolean flag indicating whether the table will include expandable rows for subcomponents.

- **`isDraggableRows?: boolean`**  
  A boolean flag to enable or disable draggable rows within the table.

## Return Value

The hook returns an object containing the following properties and functions:

- **`table: Table<TData>`**  
  The table instance generated by `@tanstack/react-table`.

- **`dataIds: UniqueIdentifier[]`**  
  Array of unique identifiers for the data rows.

- **`data: TData[]`**  
  Current dataset being displayed in the table.

- **`sorting: SortingState`**  
  Current sorting state of the table.

- **`pagination: PaginationState`**  
  Current pagination state, including page index and page size.

- **`columnOrder: ColumnOrderState`**  
  Current order of the columns in the table.

- **`columnVisibility: VisibilityState`**  
  Current visibility state of the table columns.

- **`columnPinning: PinningState`**  
  Current pinning state of the table columns.

- **`setData: React.Dispatch<React.SetStateAction<TData[]>>`**  
  Function to update the dataset in the table.

- **`setSorting: React.Dispatch<React.SetStateAction<SortingState>>`**  
  Function to update the sorting state.

- **`setPagination: React.Dispatch<React.SetStateAction<PaginationState>>`**  
  Function to update the pagination state.

- **`setColumnOrder: React.Dispatch<React.SetStateAction<ColumnOrderState>>`**  
  Function to update the column order.

- **`setColumnVisibility: React.Dispatch<React.SetStateAction<VisibilityState>>`**  
  Function to update the column visibility.

- **`setColumnPinning: React.Dispatch<React.SetStateAction<PinningState>>`**  
  Function to update the column pinning state.

- **`resetTable: () => void`**  
  Function to reset the table to its initial state, clearing sorting, pagination, and other preferences.

## State Management

The hook uses Zustand (`useDataTableStore`) to manage and persist table state, including:

- **Pagination**: Stores and retrieves pagination settings.
- **Sorting**: Stores and retrieves the sorting order of columns.
- **Column Order**: Stores and retrieves the order of columns in the table.
- **Column Visibility**: Manages which columns are visible in the table.
- **Column Pinning**: Manages the pinning of columns to the left or right sides of the table.

The `useInitialState` hook is used to initialize the columns and data row IDs.

## Usage Example

```tsx
import React from 'react';
import useDataTable from './hooks/useDataTable';
import { ColumnDef } from '@tanstack/react-table';

const columns: ColumnDef<any, any>[] = [
  // Define your column structure here
];

const defaultData = [
  // Define your data here
];

function MyTableComponent() {
  const { table, data, setData, resetTable, sorting, setSorting, pagination, setPagination } = useDataTable('my-table', defaultData, columns);

  return (
    <div>
      <TableComponent table={table} />
      {/* Render your table UI here using the returned table instance */}
      <button onClick={resetTable}>Reset Table</button>
    </div>
  );
}

export default MyTableComponent;
```

## Dependencies

The `useDataTable` hook relies on the following dependencies:

- **`@tanstack/react-table`**: Core library for creating and managing table instances.
- **`Zustand`**: State management library used to persist table state across sessions.
- **`useDataTableStore`**: Custom Zustand store for managing table state.
- **`useInitialState`**: Custom hook for initializing columns and data row IDs.

---

### back to [Datatable Library Overview](../../README.md)
