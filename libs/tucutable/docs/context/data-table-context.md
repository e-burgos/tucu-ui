# `DataTableContext` Documentation

`DataTableContext` is a React context used to create and manage a data table instance while exposing the necessary table data and state to all components within the context. This context simplifies the process of sharing and managing table state across multiple components, making it easier to build complex data tables with features like sorting, pagination, column pinning, and more.

## Table of Contents

- [`DataTableContext` Documentation](#datatablecontext-documentation)
  - [Table of Contents](#table-of-contents)
  - [Overview](#overview)
  - [Context Structure](#context-structure)
  - [Provider Component](#provider-component)
    - [`DataTableProvider`](#datatableprovider)
    - [Parameters](#parameters)
    - [Return Value](#return-value)
  - [Context Hook](#context-hook)
    - [`useDataTableProvider`](#usedatatableprovider)
    - [Return Value](#return-value-1)
  - [Usage Example](#usage-example)
  - [Dependencies](#dependencies)
    - [back to Datatable Library Overview](#back-to-datatable-library-overview)

## Overview

The `DataTableContext` provides a centralized way to manage and expose a data table's state and functionality to all components nested within the context. It leverages the `useDataTable` hook to generate the table instance and maintain its state, including data, sorting, pagination, column order, visibility, pinning, and more. Components within the context can easily access and interact with the table's state without needing to pass props down the component tree.

## Context Structure

The `DataTableContext` consists of two main parts:

1. **`DataTableProvider`**: A context provider component that initializes and provides the table state and functionality to its child components.

2. **`useDataTableProvider`**: A custom hook that allows components to access the context and interact with the table's state and functionality.

## Provider Component

### `DataTableProvider`

The `DataTableProvider` component initializes the table instance using the `useDataTable` hook and provides the resulting state and functionality to its children via a context. This allows any component within the `DataTableProvider` to access and manipulate the table's state.

### Parameters

- **`children: React.ReactNode`**  
  The child components that will have access to the table's state and functionality.

- **`tableId: string`**  
  A unique identifier for the table instance. This ID is used to manage and persist the state of the table.

- **`defaultData: TData[]`**  
  The default dataset to be displayed in the table.

- **`defaultColumns: ColumnDef<any, any>[]`**  
  An array of column definitions that describe the structure of the table's columns.

- **`initialConfig?: Partial<ColumnDef<TData, unknown>>`**  
  Optional initial configuration for the table's columns, such as size, resizing behavior, and visibility settings.

- **`isSubComponent?: boolean`**  
  A boolean flag indicating whether the table will include expandable rows for subcomponents.

- **`isDraggableRows?: boolean`**  
  A boolean flag to enable or disable draggable rows within the table.

### Return Value

The `DataTableProvider` component returns a `ReactElement` that wraps the child components and provides them with access to the table's state and functionality via the context.

## Context Hook

### `useDataTableProvider`

The `useDataTableProvider` hook allows components to access the `DataTableContext` and interact with the table's state and functionality. This hook should be used within components that are nested inside a `DataTableProvider`.

### Return Value

The `useDataTableProvider` hook returns an object containing the following properties and functions:

- **`tableId: string`**  
  The unique identifier for the table.

- **`table: Table<TData>`**  
  The table instance generated by the `useDataTable` hook.

- **`dataIds: UniqueIdentifier[]`**  
  An array of unique identifiers for the data rows.

- **`data: TData[]`**  
  The current dataset being displayed in the table.

- **`pagination: PaginationState`**  
  The current pagination state, including page size and page index.

- **`sorting: SortingState`**  
  The current sorting state of the table.

- **`columnOrder: ColumnOrderState`**  
  The current order of the columns.

- **`columnVisibility: VisibilityState`**  
  The current visibility state of the columns.

- **`columnPinning: ColumnPinningState`**  
  The current pinning state of the columns, including pinned columns on the left and right sides.

- **`setData: Dispatch<SetStateAction<TData[]>>`**  
  A function to update the dataset in the table.

- **`setPagination: (value: PaginationState) => void`**  
  A function to update the pagination state.

- **`setSorting: Dispatch<SetStateAction<SortingState>>`**  
  A function to update the sorting state.

- **`setColumnOrder: (value: ColumnOrderState) => void`**  
  A function to update the column order.

- **`setColumnVisibility: (value: VisibilityState) => void`**  
  A function to update the visibility of columns.

- **`setColumnPinning: (value: ColumnPinningState) => void`**  
  A function to update the pinning of columns.

- **`resetTable: () => void`**  
  A function to reset the table to its initial state, clearing all saved preferences.

## Usage Example

```javascript
import React from 'react';
import { DataTableProvider, useDataTableProvider } from './contexts/DataTableContext';
import { ColumnDef } from '@tanstack/react-table';

const columns: ColumnDef<any, any>[] = [
  {
    accessorKey: 'name',
    header: 'Name',
  },
  {
    accessorKey: 'age',
    header: 'Age',
  },
  // Add more columns as needed
];

const data = [
  { name: 'John Doe', age: 28 },
  { name: 'Jane Smith', age: 34 },
  // Add more data as needed
];

function MyTableComponent() {
  const {
    table,
    data,
    setData,
    resetTable,
  } = useDataTableProvider();

  return (
    <div>
      <TableComponent table={table} />
      {/* Example of using context-provided functionality */}
      <button onClick={() => setData([...data, { name: 'New User', age: 22 }])}>
        Add Row
      </button>
      <button onClick={resetTable}>Reset Table</button>
    </div>
  );
}

function App() {
  return (
    <DataTableProvider
      tableId="example-table"
      defaultData={data}
      defaultColumns={columns}
    >
      <MyTableComponent />
    </DataTableProvider>
  );
}

export default App;
```

In this example, `DataTableProvider` is used to wrap the `MyTableComponent` component, which accesses the table's state and functionality using the `useDataTableProvider` hook. The `MyTableComponent` can interact with the table's state, such as adding new rows or resetting the table.

## Dependencies

The `DataTableContext` relies on the following dependencies:

- `@tanstack/react-table`: Provides core functionality for managing table state, such as sorting, pagination, and column visibility.
- `useDataTable`: A custom hook used to generate the table instance and manage its state.
- `Zustand`: State management library used internally to create and manage the context store.

---

### back to [Datatable Library Overview](../../README.md)
